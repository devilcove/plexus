{{define "networks"}}
<!-- allow button inside <a> tag-->
<!-- [html-validate-disable element-permitted-content]-->
<!-- [html-validate-disable no-dup-id]-->
<div id="content" class="content w3-container w3-theme-dark w3-padding">
    <div id="error" class="w3-red"></div>
    <!-- Network Nav Bar-->
    <div class="w3-bar w3-theme-d5">
        <button class="w3-button" type="button" hx-get="networks/add" hx-target="#content" hx-target-error="#error">
            <i class="fa fa-network-wired"></i>
            Create New Network</button>
    </div>
    <h1>Networks</h1>
    {{range .Data}}
    <h5><button class="w3-button" type="button" hx-get="networks/{{.Name}}" hx-target="#content"
            hx-target-error="#error">
            {{.Name}}</button>{{.AddressString}}
        <button class="w3-button" type="button" hx-delete="networks/{{.Name}}" hx-target="#content"
            hx-target-error="#error" hx-confirm="Delete Network?">
            Delete</button>
    </h5>
    {{end}}
</div>
{{end}}

{{ define "addNetwork"}}
<div class="w3-container w3-theme-dark">
    <div id="error"></div>
    <h1>Add Network</h1>
    <form hx-post="/networks/add" hx-target="#content" hx-target-error="#error">
        <label for="name">Network Name</label>
        <input type="text" placeholder="network name" name="name" required><br>
        <label for="addressstring">Network CIDR</label>
        <input type="text" placeholder="10.10.10.0/24" name="addressstring" required><br>
        <p>
            <a href="/"><button class="w3-button w3-theme-dark w3-padding large" type="button">
                    Cancel</button></a>
            <button class="w3-button w3-theme-dark" type="reset">Reset</button>
            <button class="W3-button w3-theme-dark" type="submit">Add</button>
        </p>
    </form>
</div>
{{end}}

{{define "networkDetails"}}
<div class="w3-container w3-theme-dark w3-padding">
    <div id="error" class="w3-red"></div>
    <!-- Network Details Nav Bar-->
    <div class="w3-bar w3-theme-d5 w3-center">
        <button type="button" class="w3-bar-item w3-button"
            onclick="document.getElementById('addPeerToNetwork').style.display='block'">
            <i class="fa fa-desktop"></i>
            Add Peer</button>
        <button type="button" class="w3-bar-item w3-button"
            onclick="document.getElementById('addPeerToNetwork').style.display='block'">
            <i class="fa fa-share"></i>
            Create Relay</button>
        <button type="button" class="w3-bar-item w3-button"
            onclick="document.getElementById('addPeerToNetwork').style.display='block'">
            <i class="fa fa-network-wired"></i>
            Create SubNet Gateway</button>
    </div>
    <!-- Details -->
    <h1>Network: {{.Name}}</h1>
    {{$network:=.Name}}
    <h2>Peers</h2>
    <table class="w3-table w3-bordered w3-theme-l3">
        <thead>
            <tr>
                <td>Name</td>
                <td>Address</td>
                <td>Status</td>
                <td>Connected</td>
                <td>Remove</td>
            </tr>
        </thead>
        <tbody>
            {{range .Peers}}
            <tr>
                <td><button class="w3-button w3-theme" type="button" hx-get="/peers/{{.WGPublicKey}}"
                        hx-target="#content" hx-target-error="#error">{{.HostName}}</button></td>
                <td>{{.Address.IP}}</td>
                {{if .NatsConnected}}
                <td><i class="fas fa-cogs w3-green w3-large"></i></td>
                {{- else}}
                <td><i class="fas fa-cogs w3-red w3-large"></i></td>
                {{- end}}
                {{if eq .Connectivity 1.0 }}
                <td><i class="fa fa-traffic-light w3-green w3-large"></i>{{.Connectivity}}</td>
                {{else if ge .Connectivity .7}}
                <td><i class="fa fa-traffic-light w3-yellow w3-large"></i>{{.Connectivity}}</td>
                {{else if ge .Connectivity .5}}
                <td><i class="fa fa-traffic-light w3-orange w3-large"></i>{{.Connectivity}}</td>
                {{else}}
                <td><i class="fa fa-traffic-light w3-red w3-large"></i>{{.Connectivity}}</td>
                {{end}}
                <td><button class="w3-button w3-theme" type="button"
                        hx-delete="networks/peers/{{$network}}/{{.WGPublicKey}}" hx-target="#content"
                        hx-target-error="#error" hx-confirm="Remove Peer from Network?">Remove</button></td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>
{{template "addPeerToNetwork" .}}
{{end}}

{{define "addPeerToNetwork"}}
<!-- [html-validate-disable no-inline-style]-->
<div id="addPeerToNetwork" class="w3-modal">
    <div class="w3-modal-content w3-card-4 w3-animate-zoom w3-padding" style="width:50%">
        <div class="w3-container w3-center w3-theme-dark">
            {{$network:=.Name}}
            <h3>Add Peer to Network {{.Name}}</h3>
            <div class="w3-row">
                <div class="w3-col m3 w3-theme-l3">Name</div>
                <div class="w3-col m3 w3-theme-l3">Port</div>
                <div class="w3-col m3 w3-theme-l3">Endpoint</div>
            </div>
            {{range .AvailablePeers}}
            <div class="w3-row">
                <div class="w3-col m3"><button class="w3-button w3-theme" type="button"
                        hx-post="/networks/addPeer/{{$network}}/{{.WGPublicKey}}" hx-target="#content"
                        hx-target-error="#error">{{.Name}}</button></div>
                <div class="w3-col m3">{{.PublicListenPort}}</div>
                <div class="w3-col m3">{{.Endpoint}}</div>
            </div>
            {{end}}
            <br><br>
            <button type="submit" class="w3-button w3-block w3-padding"
                onclick="document.getElementById('addPeerToNetwork').style.display='none'">Close</button>
        </div>
    </div>
</div>
{{end}}